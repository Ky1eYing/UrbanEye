<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>Event 主从页示例（Vanilla JS）</title>
  <style>
    body, html { margin:0; padding:0; height:100%; }
    .container { display:flex; height:100vh; }
    /* 左侧滚动，右侧固定 */
    .main {
      flex:1; overflow-y:auto; padding:16px;
    }
    .sidebar {
      width:250px; border-left:1px solid #ccc;
      padding:16px; position:sticky; top:0; height:100vh;
      background:#fafafa;
    }
    .event-item { margin:8px 0; }
    .event-item a { text-decoration:none; color:#06c; }
  </style>
</head>
<body>
  <div class="container">
    <div class="main" id="view"></div>
    <div class="sidebar">
      <h3>固定侧栏</h3>
      <p>这里是右侧不会动的内容。</p>
    </div>
  </div>

  <script>
    // 模拟数据
    const events = [
      { id: 1, title: '演唱会' },
      { id: 2, title: '展览会' },
      { id: 3, title: '马拉松' },
    ];

    // 渲染列表页
    function renderList() {
      const view = document.getElementById('view');
      view.innerHTML = '<h2>活动列表</h2>';
      events.forEach(evt => {
        const div = document.createElement('div');
        div.className = 'event-item';
        div.innerHTML = `<a href="/event/${evt.id}" data-id="${evt.id}">${evt.title}</a>`;
        view.appendChild(div);
      });
    }

    // 渲染详情页
    function renderDetail(id) {
      const evt = events.find(e => e.id == id);
      const view = document.getElementById('view');
      if (!evt) {
        view.innerHTML = '<p>未找到该活动。</p>';
        return;
      }
      view.innerHTML = `
        <button id="back">← 返回列表</button>
        <h2>${evt.title} 详情</h2>
        <p>这里是活动 ${evt.id} 的详细描述……</p>
      `;
      // “返回”按钮
      document.getElementById('back').onclick = () => {
        history.pushState(null, '', '/event');
        router();
      };
    }

    // 基于 location.pathname 决定渲染什么
    function router() {
      const path = window.location.pathname;
      const match = path.match(/^\/event\/(\d+)$/);
      if (match) {
        renderDetail(match[1]);
      } else {
        renderList();
      }
    }

    // 拦截列表链接，改用 pushState
    document.body.addEventListener('click', e => {
      const a = e.target.closest('a[data-id]');
      if (!a) return;
      e.preventDefault();
      const id = a.dataset.id;
      history.pushState(null, '', `/event/${id}`);
      router();
    });

    // 监听浏览器前进后退
    window.addEventListener('popstate', router);

    // 初始加载
    document.addEventListener('DOMContentLoaded', router);
  </script>
</body>
</html>
