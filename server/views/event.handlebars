<div class="event-container">
    <!-- ================= [ Left Sidebar ] ================= -->
    <div class="left-sidebar">
        <!-- ================= Event List Page ================= -->
        <div id="event-list-container">
            <div class="create-event-button">
                <button id="openCreateEventModal">C R E A T E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E V E N T</button>
            </div>
            <div class="search-filter">
                <input type="text" placeholder="Search" class="search-bar">
                <select class="category-filter">
                    <option value="">All Categories</option>
                    <option value="gun shot">Gun Shot</option>
                    <option value="fight">Fight</option>
                    <option value="stealing">Stealing</option>
                    <option value="assaulting">Assaulting</option>
                    <option value="traffic jam">Traffic Jam</option>
                    <option value="road closed">Road Closed</option>
                    <option value="accident">Accident</option>
                    <option value="performance">Performance</option>
                    <option value="food truck">Food Truck</option>
                    <option value="parade">Parade</option>
                </select>
            </div>
            <div class="event-list">
                {{#if events.length}}
                {{#each events}}
                <div class="event-item" data-event-id="{{this._id}}">
                    <div class="event-image">
                        <img src="{{this.imageUrl}}" alt="{{this.title}}">
                    </div>
                    <div class="event-details">
                        <h3>{{this.title}}</h3>
                        <div class="event-meta">
                            <span>{{this.location}}</span>
                            <span>{{this.time}}</span>
                            <span>{{this.day}}</span>
                            <span>{{this.timeAgo}}</span>
                        </div>
                    </div>
                </div>
                {{/each}}
                {{else}}
                <!-- fallback 示例 -->
                <div class="event-item" data-event-id="fake-id-1">
                    <div class="event-image">
                        <img src="https://urban-eye.oss-us-east-1.aliyuncs.com/events-pic/23be41e3-7246-4ca5-b837-a801cae0f4f0-IMG_7863.JPG"
                            alt="Helicopter incident">
                    </div>
                    <div class="event-details">
                        <h3>Six killed after Helicopter Crashes</h3>
                        <div class="event-meta">
                            <span>Manhattan</span>
                            <span>8:45</span>
                            <span>Mon</span>
                            <span>6 mi</span>
                        </div>
                    </div>
                </div>
                <div class="event-item" data-event-id="fake-id-2">
                    <div class="event-image">
                        <img src="https://urban-eye.oss-us-east-1.aliyuncs.com/events-pic/23be41e3-7246-4ca5-b837-a801cae0f4f0-IMG_7863.JPG"
                            alt="Helicopter incident">
                    </div>
                    <div class="event-details">
                        <h3>Six killed after Helicopter Crashes</h3>
                        <div class="event-meta">
                            <span>Manhattan</span>
                            <span>8:45</span>
                            <span>Mon</span>
                            <span>6 mi</span>
                        </div>
                    </div>
                </div>
                {{/if}}
            </div>
        </div>

        <!-- ================= Event Detail Page ================= -->
        <div id="event-detail-container" style="display: none;">
            {{!-- Back Button --}}
            <div class="detail-header">
                <button id="backToListBtn">
                    <i class="fas fa-angle-left"></i>
                </button>
                <h3 id="detail-title">Event</h3>
            </div>

            <div class="detail-body">
                {{!-- Event Detail --}}
                <div class="detail-section">
                    <h2 id="detail-event-title"></h2>
                </div>

                <div class="detail-section">
                    <h3 class="detail-section-title">Address</h3>
                    <div class="detail-section-content">
                        <p id="detail-event-address"></p>
                        <p id="detail-event-distance" class="detail-section-content-grey"></p>
                    </div>
                </div>

                <div class="detail-event-image detail-section">
                    <img id="detail-event-img" src="" alt="Event Image">
                </div>

                <div class="detail-section no-border">
                    <h3 class="detail-section-title">Content</h3>
                    <div class="detail-section-content">
                        <div id="detail-event-content"></div>
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-section-content-grey">
                        <span id="detail-event-createdat">2:05PM Apr 11, 2025</span>
                        <span>&nbsp;&nbsp;·&nbsp;&nbsp;</span>
                        <span id="detail-event-clicktime">543 views</span>
                    </div>
                </div>

                {{!-- Event Actions --}}
                <div class="detail-section detail-event-actions">
                    <button class="action-btn like-btn" id="likeEventBtn">
                        <i class="far fa-heart"></i>
                        <span class="like-count">0</span>
                    </button>
                    <button class="action-btn comment-btn" id="CommentEventBtn">
                        <i class="far fa-comment"></i>
                        <span class="comment-count">0</span>
                    </button>
                    <button class="action-btn share-btn" id="shareEventBtn">
                        <i class="far fa-share-square"></i>
                        <span>Share</span>
                    </button>
                </div>

                {{!-- New Comment Post --}}
                <div class="detail-event-post detail-section">
                    <div class="comment-form">
                        <input type="text" class="form-input" id="newCommentInput" placeholder="Add your comment..." />
                        <button class="submit-button" id="postCommentBtn">POST</button>
                    </div>

                </div>

                {{!-- Event Comments --}}
                <div class="detail-event-comments detail-section no-border">
                    <div id="commentsList">

                        {{!-- Mock Comments only use for testing --}}
                        <div class="comment-item">
                            <div class="comment-useravator">
                                <img src="https://urban-eye.oss-us-east-1.aliyuncs.com/users-pic/sun.JPG"
                                    alt="User Avatar">
                            </div>
                            <div class="comment-body">
                                <div class="comment-header">
                                    <span class="comment-username">sun</span>
                                    <span class="comment-time">Apr 10, 17:37</span>
                                </div>
                                <div class="comment-content">
                                    RIP
                                </div>
                            </div>
                        </div>
                        <div class="comment-item">
                            <div class="comment-useravator">
                                <img src="https://urban-eye.oss-us-east-1.aliyuncs.com/users-pic/morentouxiang.png"
                                    alt="User Avatar">
                            </div>
                            <div class="comment-body">
                                <div class="comment-header">
                                    <span class="comment-username">leingano</span>
                                    <span class="comment-time">Apr 10, 17:18</span>
                                </div>
                                <div class="comment-content">
                                    may those who died rest in peace, prayers to their families and friends
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ================= Map [ Right Sidebar ] ================= -->
    <div class="map-container">
        <div id="map" class="map"></div>
    </div>

</div>

<!-- ================= Creat Event Page ( Modal ) ================= -->
<div class="modal-overlay" id="createEventModal">
    <div class="modal-content">
        <span class="modal-close" id="closeCreateEventModal">&times;</span>
        <h2>Create Event</h2>

        <div class="modal-scrollable">
            <!-- 上传图片 -->
            <div class="form-group">
                <label for="imageUpload">Image</label>
                <div class="upload-container">
                    <input type="file" id="imageUpload" accept="image/*" />
                    <div class="upload-placeholder">
                        <i class="fas fa-image"></i>
                        <span>Choose an image</span>
                    </div>
                </div>
            </div>

            <!-- 选择分类，使用纯文本按钮样式 -->
            <div class="form-group">
                <label>Category</label>
                <div class="category-chips">
                    <label>
                        <input type="radio" name="category" value="gun shot">
                        <span>Gun Shot</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="fight">
                        <span>Fight</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="stealing">
                        <span>Stealing</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="assaulting">
                        <span>Assaulting</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="traffic jam">
                        <span>Traffic Jam</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="road closed">
                        <span>Road Closed</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="accident">
                        <span>Accident</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="performance">
                        <span>Performance</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="food truck">
                        <span>Food Truck</span>
                    </label>
                    <label>
                        <input type="radio" name="category" value="parade">
                        <span>Parade</span>
                    </label>
                </div>
            </div>

            <!-- 标题、内容 -->
            <div class="form-group">
                <label for="eventTitle">Title</label>
                <input type="text" id="eventTitle" class="form-input" placeholder="Enter event title..." />
            </div>
            <div class="form-group">
                <label for="eventContent">Content</label>
                <textarea id="eventContent" rows="4" class="form-input" placeholder="Describe the event..."></textarea>
            </div>

            <!-- 地理位置：调用 Google Map 显示当前使用者位置 -->
            <div class="form-group">
                <label>Location</label>
                <div class="address-container">
                    <span id="addressOfMap"><i class="fas fa-map-marker-alt"></i>1535 Broadway, New York, NY
                        10036</span>
                    <button id="myLocation">My Location</button>
                </div>
                <div id="createEventMap" class="map-small"></div>

            </div>
        </div>

        <div class="form-actions">

            <span id="errorMessage" class="error-message"><i class="fas fa-triangle-exclamation"></i>Request
                Denied!</span>
            <button id="submitCreateEvent" class="submit-button">Submit</button>
        </div>
    </div>·
</div>


<!-- CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
<!-- choices element -->
<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<!-- JS -->
<script src="/js/helps.js" defer></script>
<script src="/js/event-modal.js" defer></script>
<script src="/js/event_list.js" defer></script>
<script src="/js/event_detail.js" defer></script>
<script src="/js/event_router.js" defer></script>
<script src="/js/event_api.js" defer></script>
<script src="/js/map.js" defer></script>




{{!-- <script>

    const isLoggedIn = {{ #if user }}true{ {else } } false{ {/if } };
    console.log('isLoggedIn: ', isLoggedIn);
    { { #if user } }
    const userInfo = {{{ json user }}};
    console.log('userInfo: {_id: '', userName: '', name: ''}: ', userInfo);
    { {/if } }
<script> --}}